---
import { personalQuestions, businessQuestions } from '@/data/homePageContent';
---

<section id="questions" class="py-20 bg-white" data-animate>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-16">
      <h2 class="text-4xl md:text-5xl font-serif font-bold text-navy-900 mb-4">
        Чи знайомі вам ці питання?
      </h2>
      <p class="text-lg text-navy-700 max-w-3xl mx-auto">
        Якщо хоча б на одне з цих питань ви відповіли "так" — я можу вам допомогти
      </p>
    </div>

    {/* Tabs */}
    <div class="flex justify-center mb-12">
      <div class="flex gap-8 border-b border-gray-200">
        <button
          id="personal-tab"
          type="button"
          class="pb-3 px-4 font-medium transition-all border-b-2 hover:text-navy-700"
          data-tab="personal"
          aria-selected="true"
          role="tab"
        >
          Особисті питання
        </button>
        <button
          id="business-tab"
          type="button"
          class="pb-3 px-4 font-medium transition-all border-b-2 hover:text-navy-700"
          data-tab="business"
          aria-selected="false"
          role="tab"
        >
          Бізнес і лідерство
        </button>
      </div>
    </div>

    {/* Tab Panels */}
    <div class="max-w-5xl mx-auto">
      {/* Personal Questions Panel */}
      <div
        id="personal-panel"
        class="grid grid-cols-1 md:grid-cols-2 gap-4"
        role="tabpanel"
        aria-labelledby="personal-tab"
      >
        {personalQuestions.map((question, index) => (
          <div
            class="p-4 pl-4 rounded-lg border border-gray-200 border-l-[3px] border-l-gold-400 hover:border-gold-200 hover:border-l-gold-500 transition-all bg-white"
            data-animate
            style={`animation-delay: ${index * 50}ms`}
          >
            <p class="text-navy-700 font-medium leading-relaxed">{question}</p>
          </div>
        ))}
      </div>

      {/* Business Questions Panel */}
      <div
        id="business-panel"
        class="hidden grid-cols-1 md:grid-cols-2 gap-4"
        role="tabpanel"
        aria-labelledby="business-tab"
      >
        {businessQuestions.map((question, index) => (
          <div
            class="p-4 pl-4 rounded-lg border border-gray-200 border-l-[3px] border-l-gold-400 hover:border-gold-200 hover:border-l-gold-500 transition-all bg-white"
            data-animate
            style={`animation-delay: ${index * 50}ms`}
          >
            <p class="text-navy-700 font-medium leading-relaxed">{question}</p>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>

<script>
  import { useUIStore } from '@/stores/uiStore';

  // Use astro:page-load to re-initialize after View Transitions navigation
  document.addEventListener('astro:page-load', () => {
    // Tab switching functionality
    const personalTab = document.getElementById('personal-tab');
    const businessTab = document.getElementById('business-tab');
    const personalPanel = document.getElementById('personal-panel');
    const businessPanel = document.getElementById('business-panel');

    function switchTab(tab: 'personal' | 'business') {
      if (tab === 'personal') {
        personalTab?.classList.add('border-gold-500', 'text-navy-900', 'font-semibold');
        personalTab?.classList.remove('border-transparent', 'text-navy-500');
        personalTab?.setAttribute('aria-selected', 'true');

        businessTab?.classList.remove('border-gold-500', 'text-navy-900', 'font-semibold');
        businessTab?.classList.add('border-transparent', 'text-navy-500');
        businessTab?.setAttribute('aria-selected', 'false');

        personalPanel?.classList.remove('hidden');
        personalPanel?.classList.add('grid');
        businessPanel?.classList.add('hidden');
        businessPanel?.classList.remove('grid');
      } else {
        businessTab?.classList.add('border-gold-500', 'text-navy-900', 'font-semibold');
        businessTab?.classList.remove('border-transparent', 'text-navy-500');
        businessTab?.setAttribute('aria-selected', 'true');

        personalTab?.classList.remove('border-gold-500', 'text-navy-900', 'font-semibold');
        personalTab?.classList.add('border-transparent', 'text-navy-500');
        personalTab?.setAttribute('aria-selected', 'false');

        businessPanel?.classList.remove('hidden');
        businessPanel?.classList.add('grid');
        personalPanel?.classList.add('hidden');
        personalPanel?.classList.remove('grid');
      }
    }

    // Initialize first tab as active
    switchTab('personal');

    personalTab?.addEventListener('click', () => switchTab('personal'));
    businessTab?.addEventListener('click', () => switchTab('business'));

    // CTA button
    const questionsCTA = document.getElementById('questions-cta');
    if (questionsCTA) {
      questionsCTA.addEventListener('click', () => {
        useUIStore.getState().openConsultationModal();
      });
    }
  });
</script>

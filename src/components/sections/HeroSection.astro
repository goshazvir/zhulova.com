---
import { heroContent } from '@/data/homePageContent';
import TrustIndicators from '@/components/hero/TrustIndicators.astro';
import HeroImage from '@/components/hero/HeroImage.astro';
import '@/styles/hero.css';

// Import hero image for Astro's responsive image optimization
import heroImageSrc from '@/assets/images/hero-viktoria-luxury.webp';
---

<section id="home" class="relative hero-section aurora-background pt-28 md:pt-32 lg:pt-28 overflow-hidden" data-animate>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 md:py-10 lg:py-16 w-full">
    <div class="grid grid-cols-1 lg:grid-cols-[55%_45%] gap-8 md:gap-8 lg:gap-16 items-center w-full max-w-full">
      <!-- Left Column: Text Content -->
      <div class="space-y-8 hero-content">
        <div class="space-y-4">
          <h1 class="hero-title font-serif font-bold text-navy-900 leading-tight text-balance">
            {heroContent.title}
          </h1>
          <p class="text-xl md:text-2xl lg:text-3xl text-gold-600 font-medium">
            {heroContent.subtitle}
          </p>
        </div>

        <p class="text-lg md:text-xl text-navy-700 leading-relaxed max-w-2xl">
          {heroContent.description}
        </p>

        <div class="flex flex-col sm:flex-row gap-4">
          <button
            id="hero-cta-button"
            type="button"
            class="hero-cta bg-gold-500 text-navy-900 px-8 py-4 text-lg font-semibold rounded-xl hover:bg-gold-400 transition-all duration-200 focus:ring-2 focus:ring-offset-2 focus:ring-gold-500 shadow-lg hover:shadow-xl"
            aria-label="Записатись на безкоштовну консультацію"
          >
            {heroContent.ctaText}
          </button>
        </div>

        <!-- Trust Indicators Component -->
        <TrustIndicators />
      </div>

      <!-- Right Column: Image Component with responsive srcset -->
      <HeroImage
        src={heroImageSrc}
        alt={heroContent.imageAlt}
        width={600}
        height={800}
      />
    </div>
  </div>

  <!-- Scroll Indicator (visible only on desktop with enough height) -->
  <div class="scroll-indicator absolute bottom-8 left-1/2 transform -translate-x-1/2 hidden lg:block">
    <div class="flex flex-col items-center text-navy-600 opacity-50 hover:opacity-75 transition-opacity cursor-pointer">
      <svg
        class="w-6 h-6 animate-bounce"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        viewBox="0 0 24 24"
        aria-hidden="true"
      >
        <path stroke-linecap="round" stroke-linejoin="round" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
      </svg>
    </div>
  </div>
</section>

<style>
  /* Scroll indicator animation */
  @keyframes bounce {
    0%, 100% {
      transform: translateY(0);
      animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
    }
    50% {
      transform: translateY(25%);
      animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
    }
  }

  .animate-bounce {
    animation: bounce 1s infinite;
  }

  /* Hide scroll indicator on small screens */
  @media (max-height: 700px) {
    .scroll-indicator {
      display: none !important;
    }
  }
</style>

<script>
  import { useUIStore } from '@/stores/uiStore';

  // Initialize on DOM ready
  document.addEventListener('DOMContentLoaded', () => {
    // Handle CTA button click
    const ctaButton = document.getElementById('hero-cta-button');
    if (ctaButton) {
      ctaButton.addEventListener('click', () => {
        useUIStore.getState().openConsultationModal();
      });
    }

    // Expose function for E2E tests
    if (typeof window !== 'undefined') {
      // @ts-ignore
      window.__openConsultationModal = () => {
        useUIStore.getState().openConsultationModal();
      };
    }

    // Handle scroll indicator click
    const scrollIndicator = document.querySelector('.scroll-indicator');
    if (scrollIndicator) {
      scrollIndicator.addEventListener('click', () => {
        const nextSection = document.getElementById('stories');
        if (nextSection) {
          nextSection.scrollIntoView({ behavior: 'smooth' });
        }
      });
    }
  });
</script>